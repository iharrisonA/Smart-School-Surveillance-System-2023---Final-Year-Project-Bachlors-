{% extends "base.html" %}
{% block title %}Announcements — SSSS{% endblock %}
{% block page_title %}Announcements{% endblock %}
{% block page_subtitle %}Create and manage school announcements{% endblock %}
{% block content %}
<div class="grid-2">
  <div class="card">
    <div class="card-header"><h3><i class="fas fa-plus" style="color: var(--success);"></i> Create Announcement</h3></div>
    <div class="card-body">
      <form method="POST">
        <div class="form-group">
          <label>Title *</label>
          <input type="text" name="title" placeholder="Announcement title" required>
        </div>
        <div class="form-group">
          <label>Announcement Details *</label>
          <textarea name="details" placeholder="Write your announcement here..." required></textarea>
        </div>
        <div class="form-grid">
          <div class="form-group">
            <label>Start Date</label>
            <input type="date" name="start_date" value="{{ today }}">
          </div>
          <div class="form-group">
            <label>End Date</label>
            <input type="date" name="end_date">
          </div>
        </div>
        <div class="form-group">
          <label>Assign To</label>
          <select name="assigned_to">
            <option value="all">All Users</option>
            <option value="teachers">Teachers Only</option>
            <option value="students">Students Only</option>
          </select>
        </div>
        <button type="submit" class="btn btn-primary"><i class="fas fa-bullhorn"></i> Announce</button>
      </form>
    </div>
  </div>

  <div class="card">
    <div class="card-header"><h3><i class="fas fa-list" style="color: var(--primary);"></i> All Announcements</h3></div>
    <div style="max-height: 500px; overflow-y: auto;">
      {% if announcements %}
        {% for ann in announcements %}
        <div style="padding: 1rem 1.25rem; border-bottom: 1px solid #f3f4f6;">
          <div class="flex justify-between items-center">
            <strong>{{ ann.title }}</strong>
            <div class="flex gap-1">
              <span class="badge badge-{{ 'success' if ann.assigned_to == 'all' else 'info' }}">{{ ann.assigned_to }}</span>
              <a href="{{ url_for('admin_delete_announcement', aid=ann.id) }}" class="btn btn-sm btn-danger" data-confirm="Delete?"><i class="fas fa-trash"></i></a>
            </div>
          </div>
          <p class="text-sm text-muted mt-1">{{ ann.details }}</p>
          <p style="font-size: 0.75rem; color: var(--muted); margin-top: 0.5rem;">
            <i class="fas fa-calendar"></i> {{ ann.start_date }} — {{ ann.end_date or 'No end date' }}
          </p>
        </div>
        {% endfor %}
      {% else %}
      <div class="empty-state"><i class="fas fa-bullhorn"></i><p>No announcements yet.</p></div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
